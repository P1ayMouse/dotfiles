# ~/.zshrc
# Advanced Zsh config with Zinit (macOS / Linux)

# ------------------------------------------------------
# PATH
# ------------------------------------------------------
export PATH="$HOME/.local/bin:$HOME/bin:/usr/local/bin:/opt/homebrew/bin:$PATH"

# ------------------------------------------------------
# Zinit (plugin manager)
# ------------------------------------------------------
ZINIT_HOME="${XDG_DATA_HOME:-$HOME/.local/share}/zinit/zinit.git"

if [[ ! -d "$ZINIT_HOME" ]]; then
  mkdir -p "$(dirname "$ZINIT_HOME")"
  git clone https://github.com/zdharma-continuum/zinit.git "$ZINIT_HOME"
fi

source "$ZINIT_HOME/zinit.zsh"

autoload -Uz _zinit
(( ${+_comps} )) && _comps[zinit]=_zinit

# ------------------------------------------------------
# History behavior
# ------------------------------------------------------
HISTFILE="$HOME/.zsh_history"
HISTSIZE=30000
SAVEHIST=30000

setopt APPEND_HISTORY
setopt SHARE_HISTORY
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_REDUCE_BLANKS
setopt INC_APPEND_HISTORY

# Navigation
setopt AUTO_CD
setopt EXTENDED_GLOB

# ------------------------------------------------------
# Completion system
# ------------------------------------------------------
autoload -Uz compinit
compinit

zstyle ':completion:*' menu select
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'

# ------------------------------------------------------
# Colors for ls (via vivid)
# ------------------------------------------------------
if command -v vivid >/dev/null 2>&1; then
  export LS_COLORS="$(vivid generate solarized-dark)"
fi

zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}

# ------------------------------------------------------
# Plugins (productivity focused)
# ------------------------------------------------------

# Suggestions from history
zinit light zsh-users/zsh-autosuggestions

# Extra completions
zinit light zsh-users/zsh-completions

# History search by substring
zinit light zsh-users/zsh-history-substring-search

# Better completion UI with fzf
zinit light Aloxaf/fzf-tab

# Auto close brackets & quotes
zinit light hlissner/zsh-autopair

# Suggest using aliases
zinit light MichaelAquilina/zsh-you-should-use

# Fast syntax highlighting (faster than classic)
zinit light zdharma-continuum/fast-syntax-highlighting

# ------------------------------------------------------
# Keybindings
# ------------------------------------------------------
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

# ------------------------------------------------------
# FZF (if installed via brew)
# ------------------------------------------------------
if command -v fzf >/dev/null 2>&1; then
  source "$(brew --prefix)/opt/fzf/shell/key-bindings.zsh"
  source "$(brew --prefix)/opt/fzf/shell/completion.zsh"
fi

# ------------------------------------------------------
# Prompt (Starship)
# Install: brew install starship
# ------------------------------------------------------
if command -v starship >/dev/null 2>&1; then
  eval "$(starship init zsh)"
fi

# ------------------------------------------------------
# Aliases
# ------------------------------------------------------
alias ll='ls -lah'
alias la='ls -A'
alias l='ls -lah'

alias gs='git status'
alias ga='git add'
alias gc='git commit'
alias gp='git push'
alias gl='git log --oneline --decorate --graph'

alias ..='cd ..'
alias ...='cd ../..'

alias c='clear'
alias h='history'

# ------------------------------------------------------
# Local overrides (not committed to dotfiles)
# ------------------------------------------------------
[[ -f "$HOME/.zshrc.local" ]] && source "$HOME/.zshrc.local"
